module.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t){e.exports=require("react")},function(e,t,r){"use strict";r.r(t),r.d(t,"GoogleButton",(function(){return v})),r.d(t,"isLoggedIn",(function(){return i})),r.d(t,"logOutOAuthUser",(function(){return a})),r.d(t,"createOAuthHeaders",(function(){return u}));var n=function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function i(e){try{u(n.next(e))}catch(e){c(e)}}function a(e){try{u(n.throw(e))}catch(e){c(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}u((n=n.apply(e,t||[])).next())}))},o=function(e,t){var r,n,o,c,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return c={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function a(c){return function(a){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,n=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,a])}}};function c(e){var t=e.email,r=void 0===t?"":t,c=e.code;(function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return[4,fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})];case 1:return[2,r.sent().json()]}}))}))})(e.apiUrl,{code:c,email:r,scope:e.scope}).then((function(t){e.setResponseState({accessToken:t.access_token})})).catch((function(t){e.setResponseState({error:t})}))}function i(){return!!window.localStorage.getItem("accessToken")}function a(){window.localStorage.removeItem("accessToken")}function u(){return{"Content-type":"application/json","X-Auth-Token":"Bearer "+window.localStorage.getItem("accessToken")}}var s,l=r(0),p=r.n(l);!function(e){e.GOOGLE_OAUTH_ENDPOINT="https://accounts.google.com/o/oauth2/v2/auth"}(s||(s={}));var d=function(){function e(e,t){var r=this;this.redirect=function(e){if(!r.googleRedirectURL)throw new ReferenceError("Error creating redirect url to Google's authorization server");window.location.replace(r.googleRedirectURL)},this.params=e,this.scopesStr=t}return Object.defineProperty(e.prototype,"googleRedirectURL",{get:function(){return this._googleRedirectURL},set:function(e){this._googleRedirectURL=e},enumerable:!1,configurable:!0}),e.prototype.createAuthorizationRequestURL=function(){var e,t=this.params,r=t.accessType,n=t.includeGrantedScopes,o=void 0===n||n,c=t.responseType,i=void 0===c?"code":c,a=t.state,u=void 0===a?null:a,l=t.redirectUri,p=t.clientId;e=s.GOOGLE_OAUTH_ENDPOINT+"?scope="+this.scopesStr+"&",e=(e=(e=r?e+"access_type="+r+"&":e)+"include_granted_scopes="+o+"&")+"response_type="+i+"&",e=(e=(e=u?e+"state="+u+"&":e)+"redirect_uri="+l+"&")+"client_id="+p,this.googleRedirectURL=e},e.createScopes=function(e){var t="";return e.map((function(r,n){e.length-1===n?t+=""+r:t+=r+"%20"})),t},e}(),f=function(){return(f=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},g={},h={backgroundSize:"20px 20px",backgroundRepeat:"no-repeat",backgroundPosition:"12px 10px",textIndent:"19px",border:"1px solid #bdc3c7",padding:"9px 23px",borderRadius:"9px",backgroundColor:"#bdc3c7",fontSize:"18px"},b=p.a.createContext({queryParamsCode:!1}),y=(b.Provider,b.Consumer,function(e){var t=e.placeholder,r=void 0===t?"":t,n=e.defaultStyle,o=void 0===n||n,c=e.options,i=d.createScopes(c.scopes),a=new d(c,i);a.createAuthorizationRequestURL();var u=o?function(e,t){return e?f(f({},t),{backgroundImage:"url("+e+")"}):t}(r,h):void 0;return p.a.createElement("button",{style:u,onClick:a.redirect},"Sign in with google")}),v=function(e){var t,r=e.callback,n=Object(l.useState)(g),o=n[0],a=n[1],u=new URLSearchParams(window.location.search),s=u.get("code"),d=u.get("error");return o.accessToken&&!i()?(t=o.accessToken,window.localStorage.setItem("accessToken",t),console.debug("`accessToken` set in local storage."),null):o.error?(console.error("Error: Api call failed with "+d+" error."),p.a.createElement(y,f({},e,{error:o.error}))):!i()&&s?(c({email:u.get("email")||"",scope:u.get("scope")||"",code:s,client_id:e.options.clientId,apiUrl:e.apiUrl,responseState:o,setResponseState:a}),console.debug("Waiting for remote api response"),r?r():p.a.createElement(p.a.Fragment,null,"Loading...")):d?(console.error("Error: Google login attempt failed with "+d+" error."),p.a.createElement(y,f({},e,{error:d}))):p.a.createElement(y,f({},e))}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZWFjdC1nb29nbGUtb2F1dGgvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vcmVhY3QtZ29vZ2xlLW9hdXRoL2V4dGVybmFsIFwicmVhY3RcIiIsIndlYnBhY2s6Ly9yZWFjdC1nb29nbGUtb2F1dGgvLi9zcmMvX2FwaVV0aWxzLnRzIiwid2VicGFjazovL3JlYWN0LWdvb2dsZS1vYXV0aC8uL3NyYy9hdXRob3JpemF0aW9uLnRzIiwid2VicGFjazovL3JlYWN0LWdvb2dsZS1vYXV0aC8uL3NyYy9jb21wb25lbnRzLnRzeCJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsInJlcXVpcmUiLCJzZXJ2ZXJSZXNwb25zZSIsInByb3BzIiwiZW1haWwiLCJjb2RlIiwiYXBpVXJsIiwicGF5bG9hZCIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwianNvbiIsInBvc3RUb0V4Y2hhbmdlQXBpVXJsIiwic2NvcGUiLCJ0aGVuIiwiZGF0YSIsInNldFJlc3BvbnNlU3RhdGUiLCJhY2Nlc3NUb2tlbiIsImFjY2Vzc190b2tlbiIsImNhdGNoIiwiZXJyIiwiZXJyb3IiLCJpc0xvZ2dlZEluIiwid2luZG93IiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImxvZ091dE9BdXRoVXNlciIsInJlbW92ZUl0ZW0iLCJjcmVhdGVPQXV0aEhlYWRlcnMiLCJHb29nbGVBUElDb25uZWN0aW9uU3RyaW5ncyIsInBhcmFtcyIsInNjb3Blc1N0ciIsInJlZGlyZWN0IiwiZSIsImdvb2dsZVJlZGlyZWN0VVJMIiwiUmVmZXJlbmNlRXJyb3IiLCJsb2NhdGlvbiIsInJlcGxhY2UiLCJ0aGlzIiwiX2dvb2dsZVJlZGlyZWN0VVJMIiwiY3JlYXRlQXV0aG9yaXphdGlvblJlcXVlc3RVUkwiLCJ1cmwiLCJhY2Nlc3NUeXBlIiwiaW5jbHVkZUdyYW50ZWRTY29wZXMiLCJyZXNwb25zZVR5cGUiLCJzdGF0ZSIsInJlZGlyZWN0VXJpIiwiY2xpZW50SWQiLCJHT09HTEVfT0FVVEhfRU5EUE9JTlQiLCJjcmVhdGVTY29wZXMiLCJzY29wZXMiLCJzdHIiLCJtYXAiLCJsZW5ndGgiLCJTRVJWRVJfUkVTUE9OU0VfU1RBVEUiLCJidXR0b25TdHlsaW5nIiwiYmFja2dyb3VuZFNpemUiLCJiYWNrZ3JvdW5kUmVwZWF0IiwiYmFja2dyb3VuZFBvc2l0aW9uIiwidGV4dEluZGVudCIsImJvcmRlciIsInBhZGRpbmciLCJib3JkZXJSYWRpdXMiLCJiYWNrZ3JvdW5kQ29sb3IiLCJmb250U2l6ZSIsIkdvb2dsZUF1dGhDb250ZXh0IiwiY3JlYXRlQ29udGV4dCIsInF1ZXJ5UGFyYW1zQ29kZSIsIklubmVyQnV0dG9uIiwiUHJvdmlkZXIiLCJDb25zdW1lciIsInBsYWNlaG9sZGVyIiwiZGVmYXVsdFN0eWxlIiwib3B0aW9ucyIsIkF1dGhvcml6YXRpb24iLCJhdXRoIiwic3R5bGVzIiwiYmFja2dyb3VuZEltYWdlIiwiX2dldEJhY2tncm91bmRJbWciLCJ1bmRlZmluZWQiLCJzdHlsZSIsIm9uQ2xpY2siLCJHb29nbGVCdXR0b24iLCJ0b2tlbiIsImNhbGxiYWNrIiwicmVzcG9uc2VTdGF0ZSIsImN1cnJlbnRVcmwiLCJVUkxTZWFyY2hQYXJhbXMiLCJzZWFyY2giLCJxdWVyeVBhcmFtc0Vy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Q3JCc0UsUUFBUXRFLE1BQU0sK0JBQStCb0UsRUFBZ0IsV0FDdEQsa0JBQUNyQixFQUFXLEtBQUtwRSxFQUFLLENBQUVxQixNQUFPZ0UsRUFBY2hFLFdBQzVDQyxLQUFnQjZDLEdBYXhCcEUsRUFUNkMsQ0FDekNFLE1BSHFCcUYsRUFBVzNHLElBQUksVUFBWSxHQUloRGtDLE1BSHFCeUUsRUFBVzNHLElBQUksVUFBWSxHQUloRHVCLEtBQU1pRSxFQUNOMEIsVUFBVzdGLEVBQU15RSxRQUFRMUIsU0FDekI1QyxPQUFRSCxFQUFNRyxPQUNka0YsY0FBYSxFQUNickUsaUJBQWdCLElBR3BCMkUsUUFBUUMsTUFBTSxtQ0FDUFIsRUFBV0EsSUFBYSxtREFDekJLLEdBQ05FLFFBQVF0RSxNQUFNLDJDQUEyQ29FLEVBQWdCLFdBQ2xFLGtCQUFDckIsRUFBVyxLQUFLcEUsRUFBSyxDQUFFcUIsTUFBT29FLE1BR25DLGtCQUFDckIsRUFBVyxLQUFLcEUiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMSk7XG4iLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJyZWFjdFwiKTsiLCIvKiogQGludGVybmFsICovXG5leHBvcnQgaW50ZXJmYWNlIElQYXlsb2FkIHtcbiAgICByZWFkb25seSBlbWFpbDogc3RyaW5nO1xuICAgIHJlYWRvbmx5IGNvZGU6IHN0cmluZztcbiAgICByZWFkb25seSBzY29wZTogc3RyaW5nO1xufVxuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IGludGVyZmFjZSBJQXBpUmVzcG9uc2VEYXRhIHsgcmVhZG9ubHkgYWNjZXNzX3Rva2VuOiBzdHJpbmc7IH1cbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwb3N0VG9FeGNoYW5nZUFwaVVybChhcGlVcmw6IHN0cmluZywgcGF5bG9hZDogSVBheWxvYWQpOiBQcm9taXNlPElBcGlSZXNwb25zZURhdGE+IHtcbiAgICBjb25zdCByZXM6IFJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYXBpVXJsLCB7XG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShwYXlsb2FkKSxcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzLmpzb24oKTtcbn1cbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXJ2ZXJSZXNwb25zZShwcm9wczogYW55KTogdm9pZCB7XG4gICAgY29uc3QgeyBlbWFpbCA9IFwiXCIsIGNvZGUsIGFwaVVybCwgc2NvcGUgfSA9IHByb3BzO1xuICAgIGNvbnN0IHBheWxvYWQ6IElQYXlsb2FkID0geyBjb2RlLCBlbWFpbCwgc2NvcGUgfTtcbiAgICBwb3N0VG9FeGNoYW5nZUFwaVVybChhcGlVcmwsIHBheWxvYWQpXG4gICAgICAgIC50aGVuKChkYXRhOiBJQXBpUmVzcG9uc2VEYXRhKSA9PiB7XG4gICAgICAgICAgICAvLyB1cGRhdGUgcmVzcG9uc2VTdGF0ZSBhY2Nlc3NUb2tlblxuICAgICAgICAgICAgcHJvcHMuc2V0UmVzcG9uc2VTdGF0ZSh7XG4gICAgICAgICAgICAgICAgYWNjZXNzVG9rZW46IGRhdGEuYWNjZXNzX3Rva2VuLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgICAgcHJvcHMuc2V0UmVzcG9uc2VTdGF0ZSh7XG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycixcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xufVxuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IGZ1bmN0aW9uIHN0b3JlQWNjZXNzVG9rZW4odG9rZW46IHN0cmluZyk6IHZvaWQge1xuICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJhY2Nlc3NUb2tlblwiLCB0b2tlbik7XG59XG5cbi8qKlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogIGlmKGlzTG9nZ2VkSW4oKSkgeyAvLyByZXR1cm5zIHRydWUgaXMgYWNjZXNzVG9rZW4gZXhpc3RzIGluIExvY2FsU3RvcmFnZVxuICogICAgICAvLyB1c2VyIGxvZ2dlZCBjb2RlLi4uXG4gKiAgfVxuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0xvZ2dlZEluKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhIXdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImFjY2Vzc1Rva2VuXCIpO1xufVxuXG4vKipcbiAqIEBleGFtcGxlXG4gKiBgYGBcbiAqICBsb2dPdXRPQXV0aFVzZXIoKSAvLyByZW1vdmVzIHRoZSBhY2Nlc3NUb2tlbiBmcm9tIExvY2FsU3RvcmFnZVxuICogYGBgXG4gKiBAcmV0dXJuIHZvaWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxvZ091dE9BdXRoVXNlcigpOiB2b2lkIHtcbiAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJhY2Nlc3NUb2tlblwiKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9nZXRBY2Nlc3NUb2tlbigpIHtcbiAgICByZXR1cm4gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYWNjZXNzVG9rZW5cIik7XG59XG5cbi8qKlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogIGZldGNoKHVybCwge1xuICogICAgICBoZWFkZXJzOiBjcmVhdGVPQXV0aEhlYWRlcnMoKSxcbiAqICB9KVxuICogYGBgXG4gKiBAcmV0dXJuIE9iamVjdFxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlT0F1dGhIZWFkZXJzKCk6IE9iamVjdCB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgXCJDb250ZW50LXR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgIFwiWC1BdXRoLVRva2VuXCI6IGBCZWFyZXIgJHtfZ2V0QWNjZXNzVG9rZW4oKX1gXG4gICAgfVxufSIsIi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCBlbnVtIEdvb2dsZUFQSUNvbm5lY3Rpb25TdHJpbmdzIHtcbiAgICBHT09HTEVfT0FVVEhfRU5EUE9JTlQgPSBcImh0dHBzOi8vYWNjb3VudHMuZ29vZ2xlLmNvbS9vL29hdXRoMi92Mi9hdXRoXCIsXG59XG4vKiogQHB1YmxpYyAqL1xuaW50ZXJmYWNlIElBdXRob3JpemF0aW9uQmFzZSB7XG4gICAgLyoqIFRoaXMgaXMgeW91ciBjbGllbnQgSUQgKi9cbiAgICBjbGllbnRJZDogc3RyaW5nO1xuICAgIC8qKiBXaGVyZSB5b3UgUmVhY3QgYXBwIHNob3VsZCByZWRpcmVjdCB0byBpZiB1c2VyIGhhcyBzdWNjZXNzZnVsbHkgbG9nZ2VkIGluICoqL1xuICAgIHJlZGlyZWN0VXJpOiBzdHJpbmc7XG4gICAgLyoqIEJ5IGRlZmF1bHQgdGhpcyBpcyBzZXQgdG8gKmNvZGUqICovXG4gICAgcmVzcG9uc2VUeXBlPzogc3RyaW5nO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyBpZiB0aGUgYXBpICoqYXBpVXJsKioge0BsaW5rIElHb29nbGVCdXR0b259IGNhbiByZWZyZXNoIHRva2VucyBvbiB0aGUgdXNlcidzXG4gICAgICogYmVoYWxmLiBUaGUgZGVmYXVsdCB2YWx1ZSBpcyAqb25saW5lKiBidXQgaWYgeW91ciBiYWNrZW5kIGFwaSB3aWxsIHJlZnJlc2ggdGhlIHRva2VuIHRoZW5cbiAgICAgKiB5b3UgbXVzdCBwYXNzIGluIGEgc3RyaW5nIHZhbHVlIG9mICpvZmZsaW5lKiAoVGhpcyBpcyByZWNvbW1lbmRlZCBmb3IgcmVhY3QgYXBwcyBjb25uZWN0ZWRcbiAgICAgKiB0byBhIFJFU1QgYXBpIGJhY2tlbmQpLlxuICAgICAqL1xuICAgIGFjY2Vzc1R5cGU/OiBzdHJpbmc7XG4gICAgLyoqXG4gICAgICogVGhpcyBvcHRpb24gaXMgY3VycmVudGx5IHVuYXZhaWxhYmxlIGJ1dCB3aWxsIGJlIGluIGEgYWRkZWQgaW4gYSBmdXR1cmUgdmVyc2lvbixcbiAgICAgKiBUT0RPIC0gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9qb2VnYXNld2ljei9yZWFjdC1nb29nbGUtb2F1dGgyLjAvaXNzdWVzLzNcbiAgICAgKiAqL1xuICAgIHN0YXRlPzogc3RyaW5nO1xuICAgIC8qKlxuICAgICAqIERlZmF1bHRlZCB0byB0cnVlLiBBbnkgZXh0cmEgc2NvcGVzIHRoZSBsb2dnZWQgaW4gdXNlciBwcmV2aW91c2x5IGdyYW50ZWRcbiAgICAgKiB3aWxsIGJlIGF2YWlsYWJsZSB3aXRoaW4gdGhlIG5ldyBhY2Nlc3MgdG9rZW4uXG4gICAgICogKi9cbiAgICBpbmNsdWRlR3JhbnRlZFNjb3Blcz86IGJvb2xlYW47XG4gICAgLyoqIE5vdCByZXF1aXJlZCwgb3B0aW9uYWwuIEZvciBwcmVmaWxsaW5nIGVtYWlsIGZpZWxkcyBldGMuICovXG4gICAgbG9naW5IaW50Pzogc3RyaW5nO1xuICAgIC8qKlxuICAgICAqIE5vdCByZXF1aXJlZCwgb3B0aW9uYWwuIEEgc3BhY2UtZGVsaW1pdGVkLCBjYXNlLXNlbnNpdGl2ZSBsaXN0IG9mIHByb21wdHMgdG9cbiAgICAgKiBwcmVzZW50IHRoZSB1c2VyLiBJZiB5b3UgZG9uJ3Qgc3BlY2lmeSB0aGlzIHBhcmFtZXRlciwgdGhlIHVzZXIgd2lsbCBiZSBwcm9tcHRlZFxuICAgICAqIG9ubHkgdGhlIGZpcnN0IHRpbWUgeW91ciBwcm9qZWN0IHJlcXVlc3RzIGFjY2Vzcy5cbiAgICAgKiAqL1xuICAgIHByb21wdD86IHN0cmluZztcbn1cbi8qKiBAcHVibGljICovXG5leHBvcnQgaW50ZXJmYWNlIElBdXRob3JpemF0aW9uT3B0aW9ucyBleHRlbmRzIElBdXRob3JpemF0aW9uQmFzZSB7XG4gICAgc2NvcGVzOiBBcnJheTxzdHJpbmc+O1xufVxuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IGludGVyZmFjZSBJQXV0aG9yaXphdGlvbiB7XG4gICAgcGFyYW1zOiBJQXV0aG9yaXphdGlvbk9wdGlvbnM7XG4gICAgLyoqIFNldCB0byAgYFtcIm9wZW5pZFwiLCBcInByb2ZpbGVcIl1gIGJ5IGRlZmF1bHQgKiovXG4gICAgc2NvcGVzU3RyOiBzdHJpbmc7XG59XG4vKiogQGludGVybmFsICovXG5leHBvcnQgY2xhc3MgQXV0aG9yaXphdGlvbiBpbXBsZW1lbnRzIElBdXRob3JpemF0aW9uIHtcblxuICAgIHByaXZhdGUgX2dvb2dsZVJlZGlyZWN0VVJMPzogc3RyaW5nO1xuXG4gICAgcHVibGljIHBhcmFtczogSUF1dGhvcml6YXRpb25PcHRpb25zO1xuXG4gICAgcHVibGljIHNjb3Blc1N0cjogc3RyaW5nO1xuXG4gICAgY29uc3RydWN0b3IocGFyYW1zOiBJQXV0aG9yaXphdGlvbk9wdGlvbnMsIHNjb3Blc1N0cjogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMucGFyYW1zID0gcGFyYW1zO1xuICAgICAgICB0aGlzLnNjb3Blc1N0ciA9IHNjb3Blc1N0cjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAaW50ZXJuYWxcbiAgICAgKiBAcHJvcGVydHkgZ29vZ2xlUmVkaXJlY3RVUkwgQWNjZXNzIHRoZSB1cmwgZm9yIHRoZSBpbml0aWFsXG4gICAgICogYnJvd3NlciBjYWxsIHRvIEdvb2dsZSdzIE9BdXRoIDIuMCBzZXJ2ZXIuIFVzZWZ1bCBmb3IgZGVidWdnaW5nLlxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgZ29vZ2xlUmVkaXJlY3RVUkwoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nb29nbGVSZWRpcmVjdFVSTDtcbiAgICB9XG5cbiAgICBwdWJsaWMgc2V0IGdvb2dsZVJlZGlyZWN0VVJMKHZhbHVlOiBzdHJpbmcgfCB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhpcy5fZ29vZ2xlUmVkaXJlY3RVUkwgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICAvKiogQGludGVybmFsICovXG4gICAgcHVibGljIGNyZWF0ZUF1dGhvcml6YXRpb25SZXF1ZXN0VVJMKCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBhY2Nlc3NUeXBlLFxuICAgICAgICAgICAgaW5jbHVkZUdyYW50ZWRTY29wZXMgPSB0cnVlLFxuICAgICAgICAgICAgcmVzcG9uc2VUeXBlID0gXCJjb2RlXCIsXG4gICAgICAgICAgICBzdGF0ZSA9IG51bGwsXG4gICAgICAgICAgICByZWRpcmVjdFVyaSxcbiAgICAgICAgICAgIGNsaWVudElkLFxuICAgICAgICB9ID0gdGhpcy5wYXJhbXM7XG4gICAgICAgIGNvbnN0IGRvbWFpbiA9IEdvb2dsZUFQSUNvbm5lY3Rpb25TdHJpbmdzLkdPT0dMRV9PQVVUSF9FTkRQT0lOVDtcbiAgICAgICAgbGV0IHVybDogc3RyaW5nO1xuICAgICAgICB1cmwgPSBgJHtkb21haW59P3Njb3BlPSR7dGhpcy5zY29wZXNTdHJ9JmA7XG4gICAgICAgIHVybCA9IGFjY2Vzc1R5cGUgPyBgJHt1cmx9YWNjZXNzX3R5cGU9JHthY2Nlc3NUeXBlfSZgIDogdXJsO1xuICAgICAgICB1cmwgPSBgJHt1cmx9aW5jbHVkZV9ncmFudGVkX3Njb3Blcz0ke2luY2x1ZGVHcmFudGVkU2NvcGVzfSZgO1xuICAgICAgICB1cmwgPSBgJHt1cmx9cmVzcG9uc2VfdHlwZT0ke3Jlc3BvbnNlVHlwZX0mYDtcbiAgICAgICAgdXJsID0gc3RhdGUgPyBgJHt1cmx9c3RhdGU9JHtzdGF0ZX0mYCA6IHVybDtcbiAgICAgICAgdXJsID0gYCR7dXJsfXJlZGlyZWN0X3VyaT0ke3JlZGlyZWN0VXJpfSZgO1xuICAgICAgICB1cmwgPSBgJHt1cmx9Y2xpZW50X2lkPSR7Y2xpZW50SWR9YDtcbiAgICAgICAgdGhpcy5nb29nbGVSZWRpcmVjdFVSTCA9IHVybDtcbiAgICB9XG5cbiAgICAvKiogQGludGVybmFsICovXG4gICAgcHVibGljIHN0YXRpYyBjcmVhdGVTY29wZXMoc2NvcGVzOiBBcnJheTxzdHJpbmc+KTogc3RyaW5nIHtcbiAgICAgICAgbGV0IHN0ciA9IFwiXCI7XG4gICAgICAgIHNjb3Blcy5tYXAoKHNjb3BlLCBpKSA9PiB7XG4gICAgICAgICAgICBpZiAoc2NvcGVzLmxlbmd0aCAtIDEgPT09IGkpIHtcbiAgICAgICAgICAgICAgICBzdHIgKz0gYCR7c2NvcGV9YDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc3RyICs9IGAke3Njb3BlfSUyMGA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gc3RyO1xuICAgIH1cblxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBwdWJsaWMgcmVkaXJlY3QgPSAoZTogYW55KTogdm9pZCA9PiB7XG4gICAgICAgIGlmKHRoaXMuZ29vZ2xlUmVkaXJlY3RVUkwpIHtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKHRoaXMuZ29vZ2xlUmVkaXJlY3RVUkwpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJFcnJvciBjcmVhdGluZyByZWRpcmVjdCB1cmwgdG8gR29vZ2xlJ3MgYXV0aG9yaXphdGlvbiBzZXJ2ZXJcIik7XG4gICAgICAgIH1cbiAgICB9XG59IiwiaW1wb3J0IHtkZWZhdWx0IGFzIFJlYWN0LCB1c2VTdGF0ZX0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQge1xuICAgIEF1dGhvcml6YXRpb24sXG4gICAgSUF1dGhvcml6YXRpb25PcHRpb25zLFxufSBmcm9tIFwiLi9hdXRob3JpemF0aW9uXCI7XG5pbXBvcnQge3NlcnZlclJlc3BvbnNlLCBzdG9yZUFjY2Vzc1Rva2VuLCBpc0xvZ2dlZElufSBmcm9tIFwiLi9fYXBpVXRpbHNcIjtcblxuLyoqIEBwdWJsaWMgKi9cbmV4cG9ydCBpbnRlcmZhY2UgSUdvb2dsZUJ1dHRvbiB7XG4gICAgLyoqIFBsYWNlaG9sZGVyIGltYWdlIGRpc3BsYXllZCBuZXh0IHRvIGJ1dHRvbiB0ZXh0ICovXG4gICAgcmVhZG9ubHkgcGxhY2Vob2xkZXI/OiBzdHJpbmc7XG4gICAgLyoqIFJlbW92ZSBkZWZhdWx0IHN0eWxlcy4gVGhlIHBsYWNlaG9sZGVyIHByb3AgaGFzIG5vIGVmZmVjdCBpZiBwbGFjZWhvbGRlciBpcyBzZXQgdG8gZmFsc2UgKi9cbiAgICByZWFkb25seSBkZWZhdWx0U3R5bGU/OiBib29sZWFuO1xuICAgIC8qKiBTZWUgSUF1dGhvcml6YXRpb25SZXF1ZXN0UGFyYW1zICovXG4gICAgcmVhZG9ubHkgb3B0aW9uczogSUF1dGhvcml6YXRpb25PcHRpb25zO1xuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eVxuICAgICAqIEBvcHRpb25hbFxuICAgICAqIEEgUmVhY3QgY29tcG9uZW50IG9yIGFueSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBSZWFjdCBjb21wb25lbnQuXG4gICAgICogVGhpcyB3b3VsZCBub3JtYWxseSBiZSB1c2VkIHRvIGRpc3BsYXkgYSBwcmVsb2FkZXIgdG8gdGhlIHVzZXIgd2hpbHN0XG4gICAgICogdGhlIE9BdXRoMi4wIGxvZ2luIHN0cmF0ZWd5IGlzIGluIGZsaWdodC4gQnkgZGVmYXVsdCBhIGBMb2FkaW5nLi4uYFxuICAgICAqIG1lc3NhZ2Ugd2lsbCBiZSBkaXNwbGF5ZWQuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBgYGBcbiAgICAgKiA8R29vZ2xlQnV0dG9uXG4gICAgICogICAgY2FsbGJhY2s9eygpID0+IDw+XCJMb2FkaW5nLi4uXCI8Lz59XG4gICAgICogICAgLy8gb3RoZXIgcHJvcHMuLi5cbiAgICAgKiAvPlxuICAgICAqIGBgYFxuICAgICAqL1xuICAgIHJlYWRvbmx5IGNhbGxiYWNrPzogKCkgPT4gUmVhY3QuUmVhY3RIVE1MRWxlbWVudDxhbnk+O1xuICAgIC8qKiBUaGUgdXJsIG9mIHRoZSBhcGkgdG8gcGVyZm9ybSB0aGUgZXhjaGFuZ2UgKi9cbiAgICByZWFkb25seSBhcGlVcmw6IHN0cmluZztcbn1cbi8qKiBAaW50ZXJuYWwgKi9cbnR5cGUgVHlwZUJ1dHRvblN0eWxlcyA9IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH07XG4vKiogQGludGVybmFsICovXG5pbnRlcmZhY2UgSUdvb2dsZUF1dGhDb250ZXh0IHsgcmVhZG9ubHkgcXVlcnlQYXJhbXNDb2RlOiBib29sZWFuOyB9XG4vKiogQGludGVybmFsICovXG5pbnRlcmZhY2UgSVNlcnZlclJlc3BvbnNlU3RhdGUgeyByZWFkb25seSBhY2Nlc3NUb2tlbj86IHN0cmluZzsgZXJyb3I/OiBzdHJpbmcgfVxuLyoqIEBpbnRlcm5hbCAqL1xuaW50ZXJmYWNlIElTZXJ2ZXJSZXNwb25zZSB7XG4gICAgcmVhZG9ubHkgZW1haWw/OiBzdHJpbmc7XG4gICAgZXJyb3I/OiBzdHJpbmc7XG4gICAgcmVhZG9ubHkgY29kZTogc3RyaW5nO1xuICAgIHJlYWRvbmx5IHNjb3BlOiBzdHJpbmc7XG4gICAgcmVhZG9ubHkgY2xpZW50X2lkOiBzdHJpbmc7XG4gICAgcmVhZG9ubHkgYXBpVXJsOiBzdHJpbmc7XG4gICAgcmVzcG9uc2VTdGF0ZTogSVNlcnZlclJlc3BvbnNlU3RhdGU7XG4gICAgc2V0UmVzcG9uc2VTdGF0ZTogYW55OyAvLyBUT0RPXG59XG4vKiogQGludGVybmFsICovXG5jb25zdCBTRVJWRVJfUkVTUE9OU0VfU1RBVEUgPSB7IH07XG4vKiogQGludGVybmFsICovXG5jb25zdCBERUZBVUxUX0dPT0dMRV9BVVRIX1NUQVRFID0geyBxdWVyeVBhcmFtc0NvZGU6IGZhbHNlIH07XG4vKiogQGludGVybmFsICovXG5jb25zdCBidXR0b25TdHlsaW5nOiBUeXBlQnV0dG9uU3R5bGVzID0ge1xuICAgIGJhY2tncm91bmRTaXplOiBcIjIwcHggMjBweFwiLFxuICAgIGJhY2tncm91bmRSZXBlYXQ6IFwibm8tcmVwZWF0XCIsXG4gICAgYmFja2dyb3VuZFBvc2l0aW9uOiBcIjEycHggMTBweFwiLFxuICAgIHRleHRJbmRlbnQ6IFwiMTlweFwiLFxuICAgIGJvcmRlcjogXCIxcHggc29saWQgI2JkYzNjN1wiLFxuICAgIHBhZGRpbmc6IFwiOXB4IDIzcHhcIixcbiAgICBib3JkZXJSYWRpdXM6IFwiOXB4XCIsXG4gICAgYmFja2dyb3VuZENvbG9yOiBcIiNiZGMzYzdcIixcbiAgICBmb250U2l6ZTogXCIxOHB4XCIsXG59O1xuLyoqIEBpbnRlcm5hbCAqL1xuY29uc3QgR29vZ2xlQXV0aENvbnRleHQgPSBSZWFjdC5jcmVhdGVDb250ZXh0PElHb29nbGVBdXRoQ29udGV4dD4oREVGQVVMVF9HT09HTEVfQVVUSF9TVEFURSk7XG5leHBvcnQgY29uc3QgR29vZ2xlQXV0aCA9IEdvb2dsZUF1dGhDb250ZXh0LlByb3ZpZGVyO1xuZXhwb3J0IGNvbnN0IEdvb2dsZUF1dGhDb25zdW1lciA9IEdvb2dsZUF1dGhDb250ZXh0LkNvbnN1bWVyO1xuLyoqIEBpbnRlcm5hbCAqL1xuY29uc3QgX2dldEJhY2tncm91bmRJbWcgPSAocGxhY2Vob2xkZXI6IHN0cmluZywgc3R5bGVzOiBUeXBlQnV0dG9uU3R5bGVzKTogVHlwZUJ1dHRvblN0eWxlcyA9PiB7XG4gICAgaWYocGxhY2Vob2xkZXIpIHtcbiAgICAgICAgcmV0dXJuIHsgLi4uc3R5bGVzLCBiYWNrZ3JvdW5kSW1hZ2U6IGB1cmwoJHtwbGFjZWhvbGRlcn0pYCB9O1xuICAgIH1cbiAgICByZXR1cm4gc3R5bGVzO1xufVxuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IGNvbnN0IElubmVyQnV0dG9uID0gKHByb3BzOiBJR29vZ2xlQnV0dG9uICYgeyBlcnJvcj86IHN0cmluZ30gJiBSZWFjdC5CdXR0b25IVE1MQXR0cmlidXRlczxIVE1MQnV0dG9uRWxlbWVudD4pID0+IHtcbiAgICBjb25zdCB7IHBsYWNlaG9sZGVyID0gXCJcIiwgZGVmYXVsdFN0eWxlID0gdHJ1ZSwgb3B0aW9ucyB9ID0gcHJvcHM7XG5cbiAgICBjb25zdCBzY29wZXMgPSBBdXRob3JpemF0aW9uLmNyZWF0ZVNjb3BlcyhvcHRpb25zLnNjb3Blcyk7XG4gICAgY29uc3QgYXV0aCA9IG5ldyBBdXRob3JpemF0aW9uKG9wdGlvbnMsIHNjb3Blcyk7XG4gICAgYXV0aC5jcmVhdGVBdXRob3JpemF0aW9uUmVxdWVzdFVSTCgpO1xuXG4gICAgY29uc3Qgc3R5bGVzID0gZGVmYXVsdFN0eWxlID8gX2dldEJhY2tncm91bmRJbWcocGxhY2Vob2xkZXIsIGJ1dHRvblN0eWxpbmcpIDogdW5kZWZpbmVkO1xuICAgIHJldHVybiA8YnV0dG9uIHN0eWxlPXtzdHlsZXN9IG9uQ2xpY2s9e2F1dGgucmVkaXJlY3R9ID5TaWduIGluIHdpdGggZ29vZ2xlPC9idXR0b24+XG59XG4vKipcbiAqIEBleGFtcGxlXG4gKiAqKlF1aWNrIFN0YXJ0OioqXG4gKlxuICogRmlyc3QgY3JlYXRlIGFuIG9wdGlvbnMgb2JqZWN0IHRoYXQgaW1wbGVtZW50cyBhbiB7QGxpbmsgIElBdXRob3JpemF0aW9uT3B0aW9uc30gdHlwZS5cbiAqIENoZWNrIHRoZSB7QGxpbmsgIElBdXRob3JpemF0aW9uT3B0aW9uc30gYW5kIHtAbGluayAgSUF1dGhvcml6YXRpb25CYXNlfSB0eXBlcyBmb3JcbiAqIGFsbCByZXF1aXJlZCBwcm9wZXJ0aWVzLiBUaGVuLCBwYXNzIHRoZSBvcHRpb25zIHRvIHRoZSB7QGxpbmsgR29vZ2xlQnV0dG9ufSBjb21wb25lbnQuXG4gKlxuICogYGBgSUF1dGhvcml6YXRpb25PcHRpb25zXG4gKiAgY29uc3Qgb3B0aW9uczogID0ge1xuICogICAgICBjbGllbnRJZDogKHByb2Nlc3MuZW52LkNMSUVOVF9JRCBhcyBzdHJpbmcpLFxuICogICAgICAgcmVkaXJlY3RVcmk6IFwiaHR0cDovL2xvY2FsaG9zdDozMDAwXCIsXG4gKiAgICAgICBzY29wZXM6IFtcIm9wZW5pZFwiLCBcInByb2ZpbGVcIiwgXCJlbWFpbFwiXSxcbiAqICAgICAgIGluY2x1ZGVHcmFudGVkU2NvcGVzOiB0cnVlLFxuICogICAgICAgYWNjZXNzVHlwZTogXCJvZmZsaW5lXCIsXG4gKiAgIH07XG4gKlxuICogICA8R29vZ2xlQnV0dG9uXG4gKiAgICAgICAgIHBsYWNlaG9sZGVyPVwiZGVtby9zZWFyY2gucG5nXCJcbiAqICAgICAgICAgb3B0aW9ucz17b3B0aW9uc31cbiAqICAgICAgICAgYXBpVXJsPVwiaHR0cDovL2xvY2FsaG9zdDo1MDAwL2dvb2dsZV9sb2dpblwiXG4gKiAgIC8+XG4gKiBgYGBcbiAqIEBwYXJhbSBwcm9wcyBzZWUgSUdvb2dsZUJ1dHRvblxuICogQGNvbnN0cnVjdG9yXG4gKi9cbmV4cG9ydCBjb25zdCBHb29nbGVCdXR0b24gPSAocHJvcHM6IElHb29nbGVCdXR0b24gJiBSZWFjdC5CdXR0b25IVE1MQXR0cmlidXRlczxIVE1MQnV0dG9uRWxlbWVudD4pID0+IHtcbiAgICBjb25zdCB7IGNhbGxiYWNrIH0gPSBwcm9wcztcbiAgICBjb25zdCBbcmVzcG9uc2VTdGF0ZSwgc2V0UmVzcG9uc2VTdGF0ZV0gPSB1c2VTdGF0ZTxJU2VydmVyUmVzcG9uc2VTdGF0ZT4oU0VSVkVSX1JFU1BPTlNFX1NUQVRFKTtcbiAgICBjb25zdCBjdXJyZW50VXJsID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKTtcbiAgICBjb25zdCBxdWVyeVBhcmFtc0NvZGUgPSBjdXJyZW50VXJsLmdldChcImNvZGVcIik7XG4gICAgY29uc3QgcXVlcnlQYXJhbXNFcnJvciA9IGN1cnJlbnRVcmwuZ2V0KFwiZXJyb3JcIik7XG4gICAgaWYocmVzcG9uc2VTdGF0ZS5hY2Nlc3NUb2tlbiAmJiAhaXNMb2dnZWRJbigpKSB7XG4gICAgICAgIHN0b3JlQWNjZXNzVG9rZW4ocmVzcG9uc2VTdGF0ZS5hY2Nlc3NUb2tlbik7XG5cbiAgICAgICAgY29uc29sZS5kZWJ1ZyhcImBhY2Nlc3NUb2tlbmAgc2V0IGluIGxvY2FsIHN0b3JhZ2UuXCIpXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH0gZWxzZSBpZiAocmVzcG9uc2VTdGF0ZS5lcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvcjogQXBpIGNhbGwgZmFpbGVkIHdpdGggJHtxdWVyeVBhcmFtc0Vycm9yfSBlcnJvci5gKVxuICAgICAgICByZXR1cm4gPElubmVyQnV0dG9uIHsuLi5wcm9wc30gZXJyb3I9e3Jlc3BvbnNlU3RhdGUuZXJyb3J9IC8+O1xuICAgIH0gZWxzZSBpZiAoIWlzTG9nZ2VkSW4oKSAmJiBxdWVyeVBhcmFtc0NvZGUpIHtcbiAgICAgICAgLy8gR2V0IHJlc3Qgb2YgcGFyYW1zXG4gICAgICAgIGNvbnN0IHF1ZXJ5UGFyYW1zRW1haWwgPSBjdXJyZW50VXJsLmdldChcImVtYWlsXCIpIHx8IFwiXCI7XG4gICAgICAgIGNvbnN0IHF1ZXJ5UGFyYW1zU2NvcGUgPSBjdXJyZW50VXJsLmdldChcInNjb3BlXCIpIHx8IFwiXCI7XG4gICAgICAgIGNvbnN0IHNlcnZlclJlc3BvbnNlUHJvcHM6IElTZXJ2ZXJSZXNwb25zZSA9IHtcbiAgICAgICAgICAgIGVtYWlsOiBxdWVyeVBhcmFtc0VtYWlsLFxuICAgICAgICAgICAgc2NvcGU6IHF1ZXJ5UGFyYW1zU2NvcGUsXG4gICAgICAgICAgICBjb2RlOiBxdWVyeVBhcmFtc0NvZGUsXG4gICAgICAgICAgICBjbGllbnRfaWQ6IHByb3BzLm9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgICBhcGlVcmw6IHByb3BzLmFwaVVybCxcbiAgICAgICAgICAgIHJlc3BvbnNlU3RhdGUsXG4gICAgICAgICAgICBzZXRSZXNwb25zZVN0YXRlLFxuICAgICAgICB9O1xuICAgICAgICBzZXJ2ZXJSZXNwb25zZShzZXJ2ZXJSZXNwb25zZVByb3BzKTtcbiAgICAgICAgY29uc29sZS5kZWJ1ZyhcIldhaXRpbmcgZm9yIHJlbW90ZSBhcGkgcmVzcG9uc2VcIik7XG4gICAgICAgIHJldHVybiBjYWxsYmFjayA/IGNhbGxiYWNrKCkgOiA8PkxvYWRpbmcuLi48Lz47XG4gICAgfSBlbHNlIGlmKHF1ZXJ5UGFyYW1zRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3I6IEdvb2dsZSBsb2dpbiBhdHRlbXB0IGZhaWxlZCB3aXRoICR7cXVlcnlQYXJhbXNFcnJvcn0gZXJyb3IuYClcbiAgICAgICAgcmV0dXJuIDxJbm5lckJ1dHRvbiB7Li4ucHJvcHN9IGVycm9yPXtxdWVyeVBhcmFtc0Vycm9yfSAvPjtcbiAgICB9XG4gICAgLy8gRGlzcGxheSBidXR0b24gd2l0aCBubyBlcnJvcnNcbiAgICByZXR1cm4gPElubmVyQnV0dG9uIHsuLi5wcm9wc30gLz47XG59XG4iXSwic291cmNlUm9vdCI6IiJ9